getwd()
setwd("../data")
#Load libraries
library(dplyr)
library(data.table)
#Read phenotype and covariates file
pheno.cov <- read.table("covariate.txt", sep=",", header = T) %>%
mutate(ID=paste(FID,":",IID,sep=""))
#Read GRM matrix
GRM <- as.matrix(fread("grm.txt.gz"))
colnames(GRM) <- pheno.cov$ID
rownames(GRM) <- pheno.cov$ID
# Environment relatedness matrix
n = nrow(pheno.cov)
K_D = matrix(nrow=n, ncol=n)
for (i in 1:n){
for (j in i:n){
K_D[i, j] = ifelse(pheno.cov$Exposed[i] == pheno.cov$Exposed[j], 1, 0)
}
}
K_D
symmetric
Symmetric
