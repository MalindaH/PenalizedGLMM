cd ..
setwd("../data")
#Read phenotype and covariates file
pheno.cov <- read.table("covariate.txt", sep=",", header = T) %>%
mutate(ID=paste(FID,":",IID,sep=""))
#Load libraries
library(dplyr)
#Read phenotype and covariates file
pheno.cov <- read.table("covariate.txt", sep=",", header = T) %>%
mutate(ID=paste(FID,":",IID,sep=""))
head(pheno.cov)
# Read covariate file
n = nrow(pheno.cov)
K_D = Array(dim=c(n, n))
K_D = array(dim=c(n, n))
K_D
pheno.cov$Exposed
# Environment relatedness matrix
n = nrow(pheno.cov)
K_D = array(dim=c(n, n))
for (i in 1:n){
for (j in i:n){
K_D[i, j] = ifelse(pheno.cov$Exposed[i] == pheno.cov$Exposed[j], 1, 0)
}
}
K_D = matrix(dim=c(n, n))
K_D = matrix(nrow=2, ncol=2)
K_D = matrix(nrow=n, ncol=n)
K_D
for (i in 1:n){
for (j in i:n){
K_D[i, j] = ifelse(pheno.cov$Exposed[i] == pheno.cov$Exposed[j], 1, 0)
}
}
View(K_D)
lower.tri(K_D) = t(upper.tri(K_D))
lower.tri(K_D)
K_D[lower.tri(K_D)]
upper.tri(K_D)
K_D[lower.tri(K_D)] <- K_D[upper.tri(K_D)]
View(K_D)
t(K_D[upper.tri(K_D)])
K_D[upper.tri(K_D)]
K_D[lower.tri(K_D)] <- t(K_D)[upper.tri(K_D)]
View(K_D)
