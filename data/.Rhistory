getwd()
setwd("../data")
library(dplyr)
library(bigsnpr)
library(ggmix)
library(data.table)
#=======================================================================
# Load the phenotype data
#=======================================================================
#Read phenotype and covariates file
pheno.cov <- read.table("covariate.txt", sep=",", header = T) %>%
mutate(ID=paste(FID,":",IID,sep=""))
n <- nrow(pheno.cov)
#=======================================================================
# Load the genotype data
#=======================================================================
tmpfile <- tempfile()
snp_readBed("geno.bed",backingfile = tmpfile)
# Attach the "bigSNP" object in R session
obj.bigSNP <- snp_attach(paste0(tmpfile, ".rds"))
p <- nrow(obj.bigSNP$map)
G <- bigsnpr::snp_fastImputeSimple(obj.bigSNP$genotypes)[,1:p] %>% scale()
#Read GRM matrix
GRM <- as.matrix(fread("grm.txt.gz"))
colnames(GRM) <- pheno.cov$ID
rownames(GRM) <- pheno.cov$ID
X <- pheno.cov[,c("AGE","SEX", paste0("x",1:19))]
X
rep(0,ncol(X))
-(1:ncol(X))
X[-(1:ncol(X))]
X[-(1:ncol(X)),]
X[,-(1:ncol(X))]
X
X[1]
